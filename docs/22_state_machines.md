# Машины состояний (State Machines) в проекте

## Обзор

Машины состояний (state machines) используются для управления жизненным циклом ключевых сущностей проекта. Они позволяют чётко определить возможные состояния объекта, события, которые могут привести к переходам между этими состояниями, а также обеспечить предсказуемость и контроль над процессами. В нашем проекте state machines применяются для таких сущностей, как Post, Story, RewriteJob и Publication.

---

## Post

| State       | Event             | Next State  | Description                                   |
|-------------|-------------------|-------------|-----------------------------------------------|
| Draft       | Submit for review | In Review   | Пользователь отправляет пост на проверку (ручное действие) |
| In Review   | Approve           | Published   | Модератор одобряет пост, он публикуется (ручное действие) |
| In Review   | Request changes   | Draft       | Модератор запрашивает доработку, пост возвращается в черновик (ручное действие) |
| Published   | Archive           | Archived    | Пост архивируется (ручное действие)          |
| Published   | Edit              | Draft       | Пользователь начинает редактирование, пост возвращается в черновик (ручное действие) |

---

## Story

| State       | Event              | Next State  | Description                                   |
|-------------|--------------------|-------------|-----------------------------------------------|
| Draft       | Submit             | Pending     | История отправляется на рассмотрение (ручное действие) |
| Pending     | Approve            | Published   | История одобрена и опубликована (ручное действие) |
| Pending     | Reject             | Draft       | История отклонена и возвращена в черновик (ручное действие) |
| Published   | Unpublish          | Draft       | История снимается с публикации и возвращается в черновик (ручное действие) |

---

## RewriteJob

| State         | Event               | Next State    | Description                                   |
|---------------|---------------------|---------------|-----------------------------------------------|
| Created       | Start processing    | Processing    | Задача на переписывание запущена (автоматическое действие) |
| Processing    | Success             | Completed     | Задача успешно выполнена (автоматическое действие) |
| Processing    | Failure             | Failed        | Произошла ошибка при выполнении задачи (автоматическое действие) |
| Failed        | Retry               | Processing    | Пользователь инициирует повторную попытку (ручное действие) |

---

## Publication

| State         | Event               | Next State    | Description                                   |
|---------------|---------------------|---------------|-----------------------------------------------|
| Queued        | Start publishing    | Publishing    | Публикация началась (автоматическое действие) |
| Publishing    | Success             | Published     | Публикация успешно завершена (автоматическое действие) |
| Publishing    | Failure             | Failed        | Публикация завершилась с ошибкой (автоматическое действие) |
| Failed        | Retry               | Publishing    | Пользователь инициирует повторную попытку публикации (ручное действие) |
