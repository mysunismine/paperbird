

# Архитектура проекта

## 1. Общая архитектура
Система состоит из бэкенда на Django, базы данных Postgres, очереди задач, воркеров, интеграций с внешними сервисами (Telethon, OpenAI API, Telegram Bot API) и веб-интерфейса на Django Templates + Bootstrap. Компоненты взаимодействуют через API и очередь задач, обеспечивая сбор, обработку, рерайтинг и публикацию контента.

## 2. Компоненты бэкенда
- **Django-приложение** — основной backend, реализует бизнес-логику и API.
- **База данных** — Postgres для хранения сущностей, статусов задач, пользователей и контента.
- **Сервисы Telethon** — интеграция с Telegram для сбора и публикации сообщений.
- **Очередь задач** — Celery или RQ для асинхронного выполнения тяжелых и периодических задач.
- **Воркеры** — отдельные процессы для обработки задач очереди (сбор, рерайт, публикация). На текущем этапе сбор реализован через management-команду `collect_posts`, работающую напрямую с Telethon.

## 3. Поток данных
1. **Сбор**: Воркеры через Telethon собирают сообщения/медиа из Telegram-каналов.
2. **Сохранение**: Полученные данные сохраняются в Postgres и/или локальное хранилище (медиа).
3. **Рерайт**: Текстовые данные отправляются на обработку (например, через OpenAI API) для рерайта.
4. **Публикация**: Обработанный контент публикуется в целевые Telegram-каналы через Telethon.

## 4. Интеграции
- **Telethon** — сбор и публикация сообщений в Telegram.
- **OpenAI API** — рерайт текстового контента.
- **Telegram Bot API** — взаимодействие с пользователями через Telegram-бота (например, управление, уведомления).

## 5. Веб-интерфейс (Frontend)
- **Django Templates + Bootstrap** — реализация пользовательского интерфейса для управления системой.
- **Взаимодействие с API** — динамические действия (например, запуск задач, просмотр статусов) через AJAX-запросы к backend API.

## 6. Хранилище и данные
- **Postgres** — основное хранилище структурированных данных (контент, статусы, пользователи).
- **Локальное хранилище** — для медиафайлов (изображения, видео), загружаемых из Telegram.
- **Возможная поддержка S3** — опционально для хранения медиа в облаке и повышения масштабируемости.

## 7. Масштабирование и расширение
- **Масштабирование воркеров** — увеличение числа воркеров для обработки большего количества задач.
- **Разделение сервисов** — выделение отдельных сервисов для сбора, рерайта и публикации.
- **Добавление новых интеграций** — подключение дополнительных API и каналов публикации.
- **Горизонтальное масштабирование** — развертывание компонентов на нескольких серверах.
- **Резервирование и мониторинг** — внедрение инструментов для мониторинга, логирования, резервного копирования.
