{% if form.non_field_errors %}
  <div class="alert alert-danger" role="alert">
    {% for error in form.non_field_errors %}
      <div>{{ error }}</div>
    {% endfor %}
  </div>
{% endif %}
<div class="mb-3">
  <label for="{{ form.type.id_for_label }}" class="form-label">{{ form.type.label }}</label>
  {{ form.type }}
  <div class="form-text">Выберите тип источника: Telegram — каналы и чаты, Web — сайты по JSON-пресетам.</div>
  {% for error in form.type.errors %}
    <div class="invalid-feedback d-block">{{ error }}</div>
  {% endfor %}
</div>
<div class="mb-3">
  <label for="{{ form.title.id_for_label }}" class="form-label">{{ form.title.label }}</label>
  {{ form.title }}
  <div class="form-text">Если оставить пустым, Paperbird подставит название автоматически.</div>
  {% for error in form.title.errors %}
    <div class="invalid-feedback d-block">{{ error }}</div>
  {% endfor %}
</div>
<div class="source-type-section" data-source-section="telegram">
  <div class="mb-3">
    <label for="{{ form.username.id_for_label }}" class="form-label">{{ form.username.label }}</label>
    {{ form.username }}
    <div class="form-text">Например, @bazabazon или https://t.me/bazabazon.</div>
    {% for error in form.username.errors %}
      <div class="invalid-feedback d-block">{{ error }}</div>
    {% endfor %}
  </div>
  <div class="mb-3">
    <label for="{{ form.invite_link.id_for_label }}" class="form-label">{{ form.invite_link.label }}</label>
    {{ form.invite_link }}
    <div class="form-text">Нужна для приватных Telegram-чатов.</div>
    {% for error in form.invite_link.errors %}
      <div class="invalid-feedback d-block">{{ error }}</div>
    {% endfor %}
  </div>
  <div class="mb-3">
    <label for="{{ form.telegram_id.id_for_label }}" class="form-label">{{ form.telegram_id.label }}</label>
    {{ form.telegram_id }}
    <div class="form-text">Опционально: числовой peer id канала.</div>
    {% for error in form.telegram_id.errors %}
      <div class="invalid-feedback d-block">{{ error }}</div>
    {% endfor %}
  </div>
</div>
<div class="source-type-section" data-source-section="web">
  <div class="mb-3">
    <label for="{{ form.preset_payload.id_for_label }}" class="form-label">{{ form.preset_payload.label }}</label>
    {{ form.preset_payload }}
    <div class="form-text">Вставьте JSON вручную или воспользуйтесь кнопкой импорта.</div>
    {% for error in form.preset_payload.errors %}
      <div class="invalid-feedback d-block">{{ error }}</div>
    {% endfor %}
  </div>
  <div class="mb-3">
    <div class="d-flex flex-wrap align-items-center gap-3">
      <button type="button" class="btn btn-outline-secondary" data-role="preset-file-button">Импортировать пресет</button>
      <span class="text-muted small" data-role="preset-import-result"></span>
    </div>
    <div class="d-none">
      {{ form.preset_file }}
    </div>
    {% for error in form.preset_file.errors %}
      <div class="invalid-feedback d-block">{{ error }}</div>
    {% endfor %}
  </div>
</div>
<div class="mb-3">
  <div class="form-check form-switch">
    {{ form.deduplicate_text }}
    <label class="form-check-label" for="{{ form.deduplicate_text.id_for_label }}">{{ form.deduplicate_text.label }}</label>
  </div>
</div>
<div class="mb-3">
  <div class="form-check form-switch">
    {{ form.deduplicate_media }}
    <label class="form-check-label" for="{{ form.deduplicate_media.id_for_label }}">{{ form.deduplicate_media.label }}</label>
  </div>
</div>
<div class="mb-3">
  <label for="{{ form.retention_days.id_for_label }}" class="form-label">{{ form.retention_days.label }}</label>
  {{ form.retention_days }}
  {% for error in form.retention_days.errors %}
    <div class="invalid-feedback d-block">{{ error }}</div>
  {% endfor %}
</div>
