{% if form.non_field_errors %}
  <div class="alert alert-danger" role="alert">
    {% for error in form.non_field_errors %}
      <div>{{ error }}</div>
    {% endfor %}
  </div>
{% endif %}

{# We are assuming the parent template defines `form_field_template` #}
{# e.g., {% with form_field_template="projects/partials/form_field.html" %} #}

<h4 class="h5">Общие параметры</h4>
<hr class="mt-2 mb-4" />
{% include form_field_template with field=form.type %}
{% include form_field_template with field=form.title %}

<div class="source-type-section" data-source-section="telegram">
  <h4 class="h5 mt-4">Параметры Telegram</h4>
  <hr class="mt-2 mb-4" />
  {% include form_field_template with field=form.username %}
  {% include form_field_template with field=form.invite_link %}
  {% include form_field_template with field=form.telegram_id %}
</div>

<div class="source-type-section" data-source-section="web">
  <h4 class="h5 mt-4">Параметры Web</h4>
  <hr class="mt-2 mb-4" />
  {% include form_field_template with field=form.preset_payload %}
  <div class="mb-3">
    <div class="d-flex flex-wrap align-items-center gap-3">
      <button type="button" class="btn btn-outline-secondary" data-role="preset-file-button">
        <i class="bi bi-upload me-1"></i>
        Импортировать пресет
      </button>
      <span class="text-muted small" data-role="preset-import-result"></span>
    </div>
    <div class="d-none">
      {{ form.preset_file }}
    </div>
    {% for error in form.preset_file.errors %}
      <div class="invalid-feedback d-block">{{ error }}</div>
    {% endfor %}
  </div>
</div>

<h4 class="h5 mt-4">Обработка постов</h4>
<hr class="mt-2 mb-4" />
{% include form_field_template with field=form.deduplicate_text %}
{% include form_field_template with field=form.deduplicate_media %}
{% include form_field_template with field=form.retention_days %}
